app-id: io.github.Soundux
runtime: org.gnome.Platform
runtime-version: "3.38"
sdk: org.gnome.Sdk
command: soundux
finish-args:
  - --device=all
  - --share=network
  - --socket=pulseaudio
  - --socket=x11
  - --filesystem=host
modules:
  - "shared-modules/libappindicator/libappindicator-gtk3-introspection-12.10.json"
  - name: soundux
    buildsystem: cmake-ninja
    config-opts:
      - -DUSE_FLATPAK=ON
      - -DCMAKE_BUILD_TYPE=Release
      - -DEMBED_PATH=src/ui/impl/webview/lib/webviewpp/embed-helper/build
    sources:
      - type: git
        url: https://github.com/Soundux/Soundux.git
        branch: master
  - name: ffmpeg
    config-opts:
      - --enable-shared
      - --disable-static
      - --disable-doc
      - --disable-ffplay
      - --disable-devices
      - --enable-gnutls
      - --enable-libmp3lame
      - --enable-libvorbis
    sources:
      - type: archive
        url: https://www.ffmpeg.org/releases/ffmpeg-4.3.2.tar.xz
        sha256: 46e4e64f1dd0233cbc0934b9f1c0da676008cad34725113fb7f802cfa84ccddb
    post-install:
      - install -Dm644 COPYING.LGPLv3 /app/share/licenses/ffmpeg/COPYING
    cleanup:
      - "/share/ffmpeg"
  - name: youtube-dl
    no-autogen: true
    no-make-install: true
    make-args:
      - youtube-dl
      - PYTHON=/usr/bin/python
    sources:
      - type: archive
        url: https://github.com/ytdl-org/youtube-dl/releases/download/2021.04.01/youtube-dl-2021.04.01.tar.gz
        sha256: f098ef95933a33096f60cb8c3bfbde710f6f84c9cad1b093082584bdc4a089ef
    post-install:
      - install -Dm0755 -t /app/bin youtube-dl
